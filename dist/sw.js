/*! For license information please see sw.js.LICENSE.txt */
chrome.runtime.onMessage.addListener(((e,r,s)=>{switch(e.type){case"TRIG_CAPTURE_QR_CODE":return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{0!==e.length?chrome.tabs.sendMessage(e[0].id,{type:"CAPTURE_QR_CODE"},(e=>{console.log("Content script response:",e),chrome.runtime.lastError?s({success:!1,error:chrome.runtime.lastError.message}):s(e)})):s({success:!1,error:"No active tab found."})})),!0;case"CAPTURE_AREA":return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{if(0===e.length)return void s({success:!1,error:"No active tab found."});const r=e[0].windowId;try{chrome.tabs.captureVisibleTab(r,{format:"png"},(e=>{chrome.runtime.lastError?s({success:!1,error:chrome.runtime.lastError.message}):s({success:!0,imageDataUrl:e})}))}catch(e){s({success:!1,error:e.message})}})),!0;default:console.warn("Unhandled message type:",e.type),s({success:!1,error:`Unhandled message type: ${e.type}`})}}));